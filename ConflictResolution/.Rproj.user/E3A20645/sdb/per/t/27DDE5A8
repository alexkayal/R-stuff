{
    "contents" : "#J3 data preparation v2\n##--- functions\nreverseLastThird <- function(series, startAt){\n  \n  skipcounter <- 0;\n  temp <-0;\n  \n  for (i in 1:nrow(series)){\n    \n    if (series$pp[i]>=startAt && \n        series$userPref01[i] == 1 \n        && skipcounter%%2==0) {\n      \n      # reversal process\n      temp <- series$total.S.A[i]\n      series$total.S.A[i] <- series$total.S.B[i]\n      series$total.S.B[i] <- temp\n      \n      if (series$norm.type[i]==\"obl\") \n        series$norm.type[i]<-\"proh\" \n      else\n        series$norm.type[i]<-\"obl\" \n      \n      series$userPref[i] <- series$userPref[i]*-1\n      series$userPref01[i] <- abs(series$userPref01[i]-1)\n      \n      series$Frnd.before[i] <- series$Frnd.before[i]*-1\n      series$Priv.before[i] <- series$Priv.before[i]*-1\n      series$Saf.before[i] <- series$Saf.before[i]*-1\n      series$Ind.before[i] <- series$Ind.before[i]*-1\n      series$Res.before[i] <- series$Res.before[i]*-1\n      \n      series$Frnd.avg[i] <- series$Frnd.avg[i]*-1\n      series$Priv.avg[i] <- series$Priv.avg[i]*-1\n      series$Saf.avg[i] <- series$Saf.avg[i]*-1\n      series$Ind.avg[i] <- series$Ind.avg[i]*-1\n      series$Res.avg[i] <- series$Res.avg[i]*-1\n      \n    }\n    \n    skipcounter <- skipcounter + 1\n    \n  }\n  \n  return(series)\n  \n}\n\n#---\n\n#imports\nlibs <- c(\"xlsx\", \"geepack\", \"glmm\", \"lme4\", \"nlme\")\nlapply(libs, require, character.only = TRUE)\n\n#Loading csv files\ntemp = list.files(pattern=\"pie*\")\nfor (i in 1:length(temp)) assign(temp[i], read.csv(temp[i]))\nJ3 <- read.csv(\"confResLimited.csv\", sep =\";\")\n\n#specifying role: parent or child\nrole <- rep(\"child\",nrow(J3))\nfor (i in 1:nrow(J3))\n  if (J3$s1a[i]==1 || J3$s1a[i]==4 || J3$s1a[i]==5 || J3$s1a[i]==7 ||\n      J3$s1a[i]==10 || J3$s1a[i]==12 || J3$s1a[i]==15 ||J3$s1a[i]==16) \n    role[i]=\"parent\"\n\n#Forming longitudunal data\nstackAB <- data.frame(pie_A.csv,pie_B.csv)\ncolnames(stackAB)[1] <- \"Frnd.before\"; colnames(stackAB)[2] <- \"Priv.before\";\ncolnames(stackAB)[3] <- \"Saf.before\"; colnames(stackAB)[4] <- \"Ind.before\";\ncolnames(stackAB)[5] <- \"Res.before\"\ncolnames(stackAB)[6] <- \"Frnd.after\"; colnames(stackAB)[7] <- \"Priv.after\";\ncolnames(stackAB)[8] <- \"Saf.after\"; colnames(stackAB)[9] <- \"Ind.after\";\ncolnames(stackAB)[10] <- \"Res.after\"\n\nstack1 <-  data.frame(J3$pp,J3$s1a,J3$s1b,J3$r1,pie_1.csv,pie_2.csv,J3$gender,J3$hasKids,role)\ncolnames(stack1)[1] <- \"pp\"; colnames(stack1)[2] <- \"S.A\";\ncolnames(stack1)[3] <- \"S.B\"; colnames(stack1)[4] <- \"userPref\";\ncolnames(stack1)[5] <- \"Frnd.A\"; colnames(stack1)[6] <- \"Priv.A\";\ncolnames(stack1)[7] <- \"Saf.A\"; colnames(stack1)[8] <- \"Ind.A\";\ncolnames(stack1)[9] <- \"Res.A\"\ncolnames(stack1)[10] <- \"Frnd.B\"; colnames(stack1)[11] <- \"Priv.B\";\ncolnames(stack1)[12] <- \"Saf.B\"; colnames(stack1)[13] <- \"Ind.B\";\ncolnames(stack1)[14] <- \"Res.B\"\ncolnames(stack1)[15] <- \"gender\"; colnames(stack1)[16] <- \"hasKids\";\n\nstack2 <-  data.frame(J3$pp,J3$s2a,J3$s2b,J3$r2,pie_3.csv,pie_4.csv,J3$gender,J3$hasKids,role)\ncolnames(stack2)[1] <- \"pp\"; colnames(stack2)[2] <- \"S.A\";\ncolnames(stack2)[3] <- \"S.B\"; colnames(stack2)[4] <- \"userPref\";\ncolnames(stack2)[5] <- \"Frnd.A\"; colnames(stack2)[6] <- \"Priv.A\";\ncolnames(stack2)[7] <- \"Saf.A\"; colnames(stack2)[8] <- \"Ind.A\";\ncolnames(stack2)[9] <- \"Res.A\"\ncolnames(stack2)[10] <- \"Frnd.B\"; colnames(stack2)[11] <- \"Priv.B\";\ncolnames(stack2)[12] <- \"Saf.B\"; colnames(stack2)[13] <- \"Ind.B\";\ncolnames(stack2)[14] <- \"Res.B\"\ncolnames(stack2)[15] <- \"gender\"; colnames(stack2)[16] <- \"hasKids\"\n\nstack3 <-  data.frame(J3$pp,J3$s3a,J3$s3b,J3$r3,pie_5.csv,pie_6.csv,J3$gender,J3$hasKids,role)\ncolnames(stack3)[1] <- \"pp\"; colnames(stack3)[2] <- \"S.A\";\ncolnames(stack3)[3] <- \"S.B\"; colnames(stack3)[4] <- \"userPref\";\ncolnames(stack3)[5] <- \"Frnd.A\"; colnames(stack3)[6] <- \"Priv.A\";\ncolnames(stack3)[7] <- \"Saf.A\"; colnames(stack3)[8] <- \"Ind.A\";\ncolnames(stack3)[9] <- \"Res.A\"\ncolnames(stack3)[10] <- \"Frnd.B\"; colnames(stack3)[11] <- \"Priv.B\";\ncolnames(stack3)[12] <- \"Saf.B\"; colnames(stack3)[13] <- \"Ind.B\";\ncolnames(stack3)[14] <- \"Res.B\"\ncolnames(stack3)[15] <- \"gender\"; colnames(stack3)[16] <- \"hasKids\"\n\nstack4 <-  data.frame(J3$pp,J3$s4a,J3$s4b,J3$r4,pie_7.csv,pie_8.csv,J3$gender,J3$hasKids,role)\ncolnames(stack4)[1] <- \"pp\"; colnames(stack4)[2] <- \"S.A\";\ncolnames(stack4)[3] <- \"S.B\"; colnames(stack4)[4] <- \"userPref\";\ncolnames(stack4)[5] <- \"Frnd.A\"; colnames(stack4)[6] <- \"Priv.A\";\ncolnames(stack4)[7] <- \"Saf.A\"; colnames(stack4)[8] <- \"Ind.A\";\ncolnames(stack4)[9] <- \"Res.A\"\ncolnames(stack4)[10] <- \"Frnd.B\"; colnames(stack4)[11] <- \"Priv.B\";\ncolnames(stack4)[12] <- \"Saf.B\"; colnames(stack4)[13] <- \"Ind.B\";\ncolnames(stack4)[14] <- \"Res.B\"\ncolnames(stack4)[15] <- \"gender\"; colnames(stack4)[16] <- \"hasKids\"\n\ntotal <-rbind(data.frame(stack1,stackAB),data.frame(stack2,stackAB),\n              data.frame(stack3,stackAB),data.frame(stack4,stackAB))\ntotal <- total[with(total, order(pp)), ]\n\n# calculating averages of the two pies\ntotal$Frnd.avg = (total$Frnd.before+total$Frnd.after)/2\ntotal$Priv.avg = (total$Priv.before+total$Priv.after)/2\ntotal$Saf.avg = (total$Frnd.before+total$Saf.after)/2\ntotal$Ind.avg = (total$Priv.before+total$Ind.after)/2\ntotal$Res.avg = (total$Priv.before+total$Res.after)/2\n",
    "created" : 1456913259475.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1940613524",
    "id" : "27DDE5A8",
    "lastKnownWriteTime" : 1455877724,
    "path" : "~/Documents/Work/R data/J3Official/J3dataprepv2.R",
    "project_path" : "J3dataprepv2.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_source"
}